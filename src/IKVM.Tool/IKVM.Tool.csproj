<Project Sdk="Microsoft.NET.Sdk">

    <PropertyGroup>
        <TargetFrameworks>net461;netcoreapp3.1</TargetFrameworks>
        <IncludeTools>true</IncludeTools>
    </PropertyGroup>

    <ItemGroup>
        <PackageReference Include="CliWrap" Version="3.4.4" />
    </ItemGroup>

    <ItemGroup Condition=" '$(IncludeTools)' == 'true' ">
        <PublishProjectReference Include="..\ikvm\ikvm.csproj">
            <SetTargetFramework>TargetFramework=net461</SetTargetFramework>
            <PublishTargetPath>ikvm-tools\net461</PublishTargetPath>
            <PublishProperties>SelfContained=false</PublishProperties>
        </PublishProjectReference>
        <PublishProjectReference Include="..\ikvmc\ikvmc.csproj">
            <SetTargetFramework>TargetFramework=net461</SetTargetFramework>
            <PublishTargetPath>ikvm-tools\net461</PublishTargetPath>
            <PublishProperties>SelfContained=false</PublishProperties>
        </PublishProjectReference>
        <PublishProjectReference Include="..\ikvmstub\ikvmstub.csproj">
            <SetTargetFramework>TargetFramework=net461</SetTargetFramework>
            <PublishTargetPath>ikvm-tools\net461</PublishTargetPath>
            <PublishProperties>SelfContained=false</PublishProperties>
        </PublishProjectReference>
        <PublishProjectReference Include="..\ikvm\ikvm.csproj">
            <SetTargetFramework>TargetFramework=netcoreapp3.1</SetTargetFramework>
            <PublishTargetPath>ikvm-tools\netcoreapp3.1</PublishTargetPath>
            <PublishProperties>SelfContained=false</PublishProperties>
        </PublishProjectReference>
        <PublishProjectReference Include="..\ikvmc\ikvmc.csproj">
            <SetTargetFramework>TargetFramework=netcoreapp3.1</SetTargetFramework>
            <PublishTargetPath>ikvm-tools\netcoreapp3.1</PublishTargetPath>
            <PublishProperties>SelfContained=false</PublishProperties>
        </PublishProjectReference>
        <PublishProjectReference Include="..\ikvmstub\ikvmstub.csproj">
            <SetTargetFramework>TargetFramework=netcoreapp3.1</SetTargetFramework>
            <PublishTargetPath>ikvm-tools\netcoreapp3.1</PublishTargetPath>
            <PublishProperties>SelfContained=false</PublishProperties>
        </PublishProjectReference>
    </ItemGroup>

</Project>
